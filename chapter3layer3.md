- ルーター
  - パケットを次のルーターに転送する
  - ルーティングテーブルと言う道路標識みたいなもので次の宛先を判断する
  - 次のルーターに送るのをフォワーディングと言う
  - ルーティングテーブル
    - 宛先のネットワークとそのネットワークに送るための転送先と優先度が書いてある
    - 転送先は隣のルーターやそれに送るためのネットワークインターフェースなど
  - IPアドレス
    - 前半がネットワーク部で、後半がホスト部
    - ネットマスクでネットワーク部を取り出せる。
    - ネットワーク部がそのIPアドレスの所属するネットワークを表す
    - ネットワークはIPアドレスの集合体
    - ネットワークマスクはprefix数でも表現できる。192.0.1.0/24とかはprefix数を使ってネットワークを表現してる
- デフォルトゲートウェイ
  - 他に設定がなかったネットワークとの接続に使うルーター的な感じ
  - 家庭内LANであればインターネットに繋ぐためのゲートウェイは1つだけで、このデフォルトゲートウェイを使って通信する
- 動的ルーティング
  - ルーターが自律的にルーティングテーブルを作る
  - 組織やプロバイダの内部ネットワークではOSPSと言うそれぞれのルーターのお隣情報を使って、ネットワーク全体の地図を作る
  - インターネットはネットワークのネットワークなので、ネットワーク内のルーティングとネットワーク同士のルーティングがある
  - ネットワーク内がIGP, ネットワーク同士がEGP
  - インターネットを構成するネットワークをASと言う。Google, Amazon, Facebook, さくらなどはASを持ってる。
  - AS内はASが自由にプロトコルを選べるが、AS間はBGPと言うプロトコルで通信をする
  - BGPでどのASにどのネットワークがあるかと言う情報を伝言ゲームみたいに伝え合ってる
- IPv4パケット
  - ヘッダー部とデータ部がある。データ部はペイロードとも呼ばれる
  - ヘッダー
    - バージョン
    - length
    - パケット分割した場合のフラグメントのID
    - 最大転送回数
    - チェックサム
    - 送信元・送信先のIPアドレス
- パケットは入れ子になってる
- IPヘッダーの外側にイーサネットヘッダー。内側にはTCPヘッダー。
  - イーサネットヘッダーを含むものをイーサネットフレームと呼ぶ。NICはこれを受け取り、イーサネットヘッダを取り除いた、IPパケットをカーネルに渡す
- L1
  - 物理層
  - 光ファイバ、電話回線、LANケーブル、無線
  - これらを使って01を送り合えるという形で抽象化されてる
- L2
  - 隣の機器との論理的な接続
  - 物理的な接続の隠蔽
  - プロトコルを揃えてやり取りできるようにする
- L3
  - 隣より離れた機器にパケットを届ける
- L4
  - パケットを並列的にやり取りできるようにセッションを管理したりする

## ネットワークインターフェースについて
`ifconfig -a`でネットワークインターフェースの一覧が見られる
今の場合だと、en0を通じて、wifiを通じて、ココスのネットワークに繋がってる
このネットワーク内であればルーターを通じて直接やり取りできるし、それ以外のIPアドレスであれば、デフォルトゲートウェイを通じてやり取りできる

## LINEはASを持ってる？ASの一覧見られる？
ここで日本の一覧を見られるらしい
https://www.nic.ad.jp/ja/ip/as-numbers.txt
LINEも載ってる

以下で自分がどのASにいるかわかる
https://bgpview.io/

## やりたい
- ハンドでIPパケットを作りたい。